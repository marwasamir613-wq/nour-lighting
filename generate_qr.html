<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>بصمة QR الذكية - شركة نور</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet"/>
    <style>
        body { font-family: 'Cairo', sans-serif; background: #0f172a; color: white; }
        #qrcode img { margin: auto; border: 15px solid white; border-radius: 1.5rem; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6 text-center">

    <div class="mb-8">
        <h1 class="text-3xl font-black italic text-blue-400 uppercase tracking-widest">NOUR SMART QR</h1>
        <p class="text-slate-400 font-bold italic mt-2">سجل حضورك - الكود يتغير كل <span id="timer" class="text-white text-xl">20</span> ثانية</p>
    </div>

    <div id="qrcode" class="shadow-2xl shadow-blue-500/20 p-4 bg-white rounded-[2.5rem]"></div>

    <div class="mt-10 space-y-2">
        <p id="currentTime" class="text-sm font-mono text-blue-300"></p>
        <p class="text-[10px] text-slate-500 uppercase font-black italic"> مبرمجة التطبيق: مروه سمير </p>
    </div>

    <script>
        const qrContainer = document.getElementById("qrcode");
        const timerLabel = document.getElementById("timer");
        let qrCodeCreator = new QRCode(qrContainer, { width: 280, height: 280 });

        function generateSecureQR() {
            // توليد مفتاح مشفر يعتمد على الوقت (كل 20 ثانية)
            const timestamp = Math.floor(Date.now() / 20000); 
            const secretKey = "NOUR_LIGHTING_2026"; // مفتاح خاص بالشركة
            const secureData = `ATTENDANCE_${secretKey}_${timestamp}`;

            qrCodeCreator.clear(); 
            qrCodeCreator.makeCode(secureData);
            
            console.log("تم تحديث الكود:", secureData);
        }

        // عداد الثواني
        let timeLeft = 20;
        setInterval(() => {
            timeLeft--;
            timerLabel.innerText = timeLeft;
            if (timeLeft <= 0) {
                timeLeft = 20;
                generateSecureQR();
            }
            document.getElementById('currentTime').innerText = new Date().toLocaleTimeString('ar-EG');
        }, 1000);

        // التوليد لأول مرة
        generateSecureQR();
    </script>
</body>
</html>