<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>تفاصيل الراتب - شركة نور</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <style>body { font-family: 'Cairo', sans-serif; background-color: #f6f7f8; }</style>
</head>
<body class="p-6 text-right italic font-bold">
    <header class="flex items-center gap-4 mb-8 max-w-md mx-auto">
        <button onclick="window.location.href='home.html'" class="w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center active:scale-90 transition-all">
            <span class="material-icons text-slate-600">arrow_forward</span>
        </button>
        <h1 class="text-xl font-black text-slate-800 uppercase italic">تفاصيل كشف الراتب</h1>
    </header>

    <main class="max-w-md mx-auto space-y-4">
        <div class="bg-white p-6 rounded-[2.5rem] shadow-xl border border-blue-50 space-y-5 relative overflow-hidden">
            <div class="absolute -top-10 -left-10 w-32 h-32 bg-blue-50 rounded-full opacity-50"></div>

            <div class="flex justify-between items-center border-b border-slate-50 pb-4">
                <span class="text-slate-500 font-black italic uppercase text-[12px]">الراتب الأساسي</span>
                <span id="detBase" class="font-black text-slate-800">0 ج.م</span>
            </div>
            
            <div class="flex justify-between items-center border-b border-slate-50 pb-4 text-emerald-600">
                <span class="font-black italic uppercase text-[12px]">المكافآت والحوافز (+)</span>
                <span id="detBonus" class="font-black">0 ج.م</span>
            </div>

            <div class="flex justify-between items-center border-b border-slate-50 pb-4 text-orange-500">
                <span class="font-black italic uppercase text-[12px]">أيام الغياب (-)</span>
                <span id="detAbsence" class="font-black">0 ج.م</span>
            </div>

            <div class="flex justify-between items-center border-b border-slate-50 pb-4 text-red-400">
                <span class="font-black italic uppercase text-[12px]">السلف المستردة (-)</span>
                <span id="detLoans" class="font-black">0 ج.م</span>
            </div>

            <div class="flex justify-between items-center border-b border-slate-50 pb-4 text-red-500">
                <span class="font-black italic uppercase text-[12px]">التأمينات الاجتماعية (-)</span>
                <span id="detInsurance" class="font-black">0 ج.م</span>
            </div>

            <div class="flex justify-between items-center border-b border-slate-50 pb-4 text-red-700">
                <span class="font-black italic uppercase text-[12px]">الجزاءات والخصومات (-)</span>
                <span id="detPenalty" class="font-black">0 ج.م</span>
            </div>
            
            <div class="bg-[#137fec] p-6 rounded-[2rem] text-white text-center mt-6 shadow-2xl shadow-blue-200">
                <p class="text-[10px] font-bold opacity-80 mb-1 uppercase tracking-widest italic">الصافي الذي سيتم صرفه</p>
                <p id="detNet" class="text-3xl font-black italic">0 ج.م</p>
            </div>
        </div>

        <p class="text-center text-[9px] text-slate-400 mt-6 font-black uppercase italic tracking-tighter">
            * هذا الكشف معتمد من الإدارة المالية لشركة نور
        </p>
    </main>

    <script>
        window.onload = function() {
            loadSalaryDetails();
        };

        function loadSalaryDetails() {
            // 1. نجلب اسم الموظف المسجل دخول
            const loggedInEmp = localStorage.getItem('logged_in_employee_name') || "مروه سمير حسن";
            const employees = JSON.parse(localStorage.getItem('nour_employees')) || [];
            const me = employees.find(e => e.name === loggedInEmp);

            if (me) {
                // حسبة "سعر الغياب" التقريبية للعرض
                const dailyRate = parseFloat(me.dailyRate) || 0;
                const absentDays = parseFloat(me.absentDays) || 0;
                const totalAbsenceCost = dailyRate * absentDays;

                // الصافي النهائي (الحسبة الموحدة)
                const base = parseFloat(me.baseSalary) || 0;
                const bonus = parseFloat(me.bonuses) || 0;
                const loans = parseFloat(me.loans_deducted_this_month) || 0; // السلفة اللي اتخصمت الشهر ده
                const insurance = parseFloat(me.insurance) || 0;
                const penalty = parseFloat(me.penalties) || 0;
                
                // تحديث الشاشة
                document.getElementById('detBase').innerText = base.toLocaleString() + " ج.م";
                document.getElementById('detBonus').innerText = bonus.toLocaleString() + " ج.م";
                document.getElementById('detAbsence').innerText = totalAbsenceCost.toLocaleString() + " ج.م";
                document.getElementById('detLoans').innerText = loans.toLocaleString() + " ج.م";
                document.getElementById('detInsurance').innerText = insurance.toLocaleString() + " ج.م";
                document.getElementById('detPenalty').innerText = penalty.toLocaleString() + " ج.م";
                
                // الصافي النهائي
                const net = (base + bonus) - (totalAbsenceCost + insurance + penalty + loans);
                document.getElementById('detNet').innerText = (net > 0 ? net : 0).toLocaleString() + " ج.م";
            }
        }
    </script>
</body>
</html>